import{b as r,R as g,h as f,c as p,r as b,j as i}from"./index-CCQKC7kY.js";import{g as m,r as x,p as S,b as h}from"./ajax-DLEL1G7a.js";import{u as D}from"./useSelectedBot-DY2XvfN5.js";import{S as w}from"./send-BIiBs9Cb.js";import{B as I}from"./Button-Bb0NqqiR.js";import"./Button-DesRcnRR.js";import"./index-Cr1SGxRI.js";import{F as k,b as j,d as C}from"./index-CpGoEiWJ.js";async function F(a){const{organizationId:c,selectedBotId:t,kbDocs:e}=r.getState(),s=await m(`/bot/${c}/${t}/knowledge-base/list`);r.setState(o=>({kbDocs:{...o.kbDocs||{},[String(t)]:s}}))}async function B(a){const{organizationId:c,selectedBotId:t}=r.getState(),e=await S(`/bot/${c}/${t}/knowledge-base`,a);return r.setState(s=>{const o={...s.kbDocs||{}},n=o[t];if(!n)return{};if(o[t]=[...n],a._id){const l=o[t].findIndex(u=>u._id===e._id);l>=0?o[t][l]=e:o[t].push(e)}else o[t].push(e);return{kbDocs:o}}),e}async function P(a){const{organizationId:c,selectedBotId:t}=r.getState();await x(`/bot/${c}/${t}/knowledge-base/${a}`,a),r.setState(e=>{var o;const s={...e.kbDocs||{}};return s[t]=(o=s[t])==null?void 0:o.filter(n=>n._id!==a),{kbDocs:s}})}const d=f(()=>({page:1,rowsPerPage:10,totalDocs:0,docsList:[],isLoading:!1}));function _(){const a=r(s=>s.organizationId),[c]=D();g.useEffect(()=>{L()},[c,a]);const t=d(s=>s.docsList),e=d(s=>s.isLoading);return[t,e]}async function L(a=1,c=10){const{organizationId:t}=r.getState(),{selectedBotId:e}=p.getState();if(!t||!e)return;const{botId:s}=d.getState(),o={page:a,rowsPerPage:c,isLoading:!0};s!==e&&(o.docsList=[]),d.setState(o);const n=await h.get(`/bot/${t}/${e}/knowledge-base/list`);d.setState({botId:e,docsList:n,totalDocs:n.length,isLoading:!1})}function A({onDone:a,initial:c}){const[t,e]=b.useState(c||{question:"",content:""}),s=(n,l)=>{e(u=>({...u,[n]:l}))},o=async()=>{const n=await B(t);console.log("result",n),a()};return i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("div",{className:"font-bold text-lg pb-1 text-center",children:"Add document"}),i.jsxs(k,{value:t,onChange:e,children:[i.jsx(j,{field:"question",placeholder:"Provide title or question for the content",label:"Question",wrapperClassName:"h-6",onChange:n=>s("question",n)}),i.jsx(C,{field:"content",placeholder:"Provide content or answer for the question",label:"Content",className:"h-24",onChange:n=>s("content",n)})]}),i.jsx("div",{className:"text-center",children:i.jsx(I,{icon:i.jsx(w,{}),size:"lg",type:"rounded",onClick:o,className:"bg-[#49d4a1]"})})]})}export{A as E,P as d,F as g,_ as u};
