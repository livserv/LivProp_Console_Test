import{j as e,c as k,h as I,R as N}from"./AlertSnackbar-BBOi9bHj.js";import{a as L,F as E}from"./formik.esm-WsGY0UtP.js";import{a as B}from"./index-CVdVTGYS.js";import{c as C,f as M,a as b}from"./index.esm-DQc3wIMG.js";import{S}from"./delete-BYa5uglT.js";import{B as w}from"./Button-Cm50jxWY.js";import"./index-B4Pd27tI.js";import"./Button-htJsKnEd.js";import{T as u}from"./TextBox-DU8s_y0c.js";import{A as K}from"./AnimateButton-DLDqu4Ov.js";import{P as R}from"./ProgressButton-DbRXTBvR.js";import{Y as y}from"./YesNoDropdown-ByVQm1Qa.js";import{s as D}from"./bots-BMhX1rh2.js";import{u as F}from"./useSelectedBot-CTuACohy.js";import{P as A}from"./PageHeader-CFxyZRKj.js";import"./env-CmL5wTXD.js";import"./LabelWrapper-O3YM8ZQf.js";import"./SelectBox-SgIxSiS9.js";import"./organization-B9OzZuX7.js";function G({values:s,errors:a,touched:t,handleBlur:r,handleChange:n,setFieldValue:l,isSubmitting:x}){const o=s.chatReportPropList||[],c=i=>i.map((g,h)=>({...g,itemNo:h+1}));return e.jsxs("div",{className:"w-full col-span-12",children:[e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("div",{className:"px-4 text-gray-600 font-medium text-base",children:"Add columns to Excel sheet"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),e.jsx("div",{className:"col-span-6 border-b",children:e.jsx(L,{name:"chatReportPropList",children:({push:i})=>e.jsxs(e.Fragment,{children:[o.length===0&&e.jsx("div",{className:"flex justify-center items-center py-4 text-gray-500 text-sm",children:"No chat property columns have been added to the Excel sheet yet."}),o.map((g,h)=>e.jsx($,{leadProps:g,index:h,handleBlur:r,handleChange:n,errors:a,touched:t,remove:p=>{const d=o.filter((m,f)=>f!==p);l("chatReportPropList",c(d))}},h)),e.jsx("div",{className:"flex flex-wrap justify-end mb-2",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsx(w,{className:"ml-2",type:"primary",size:"sm",label:"+",onClick:()=>i({label:"",prop:""}),disabled:x,title:"Add Excel sheet columns"})})})]})})})]})}function $({leadProps:s,index:a,handleBlur:t,handleChange:r,errors:n,touched:l,remove:x}){const o=l?.chatReportPropList?.[a]?.label&&n?.chatReportPropList?.[a]?.label,c=l?.chatReportPropList?.[a]?.prop&&n?.chatReportPropList?.[a]?.prop;return e.jsx("div",{className:"w-full lg:w-9/12",children:e.jsx("div",{className:"mb-4 pb-4 col-span-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(u,{id:`chatReportPropList.${a}.label`,name:`chatReportPropList.${a}.label`,label:"Label",type:"text",value:s.label,onBlur:t,onChange:r,autoComplete:"off",placeholder:"Project",className:o?"border-red-500":""}),o&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:n.chatReportPropList[a].label})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(u,{id:`chatReportPropList.${a}.prop`,name:`chatReportPropList.${a}.prop`,label:"Prop Name",type:"text",value:s.prop,onBlur:t,onChange:r,autoComplete:"off",placeholder:"fld1",className:c?"border-red-500":""}),c&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:n.chatReportPropList[a].prop})]}),e.jsx("div",{className:"flex flex-col items-center ",children:e.jsx(w,{type:"plain",icon:e.jsx(S,{}),size:"lg",className:"text-2xl text-red-600",onClick:()=>x(a)})})]})})})}function W({tagManagerIds:s,index:a,handleBlur:t,handleChange:r,errors:n,touched:l,remove:x}){const o=l?.urlBasedGoogleTagManagerIds?.[a]?.url&&n?.urlBasedGoogleTagManagerIds?.[a]?.url,c=l?.urlBasedGoogleTagManagerIds?.[a]?.tagManagerId&&n?.urlBasedGoogleTagManagerIds?.[a]?.tagManagerId;return e.jsx("div",{className:"w-full lg:w-9/12",children:e.jsx("div",{className:"mb-4 pb-4 col-span-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(u,{id:`urlBasedGoogleTagManagerIds.${a}.url`,name:`urlBasedGoogleTagManagerIds.${a}.url`,label:"Page Url",type:"text",value:s.url,onBlur:t,onChange:r,autoComplete:"off",placeholder:"www.url.com",className:o?"border-red-500":""}),o&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:n.urlBasedGoogleTagManagerIds[a].url})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(u,{id:`urlBasedGoogleTagManagerIds.${a}.tagManagerId`,name:`urlBasedGoogleTagManagerIds.${a}.tagManagerId`,label:"Tag Manager Id",type:"text",value:s.tagManagerId,onBlur:t,onChange:r,autoComplete:"off",placeholder:"GTM-XXXXXX",className:c?"border-red-500":""}),c&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:n.urlBasedGoogleTagManagerIds[a].tagManagerId})]}),e.jsx("div",{className:"flex flex-col items-center ",children:e.jsx(w,{type:"plain",icon:e.jsx(S,{}),size:"lg",className:"text-2xl text-red-600",onClick:()=>x(a)})})]})})})}function X({values:s,errors:a,touched:t,handleBlur:r,handleChange:n,setFieldValue:l,isSubmitting:x}){const o=s.urlBasedGoogleTagManagerIds||[],c=i=>i.map((g,h)=>({...g,itemNo:h+1}));return e.jsxs("div",{className:"w-full col-span-12",children:[e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("div",{className:"px-4 text-gray-600 font-medium text-base",children:"Url based Tag Manager Id"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),e.jsx("div",{className:"col-span-6 border-b",children:e.jsx(L,{name:"urlBasedGoogleTagManagerIds",children:({push:i})=>e.jsxs(e.Fragment,{children:[o.length===0&&e.jsx("div",{className:"flex justify-center items-center py-4 text-gray-500 text-sm",children:"No Google TagManager Id added yet"}),o.map((g,h)=>e.jsx(W,{tagManagerIds:g,index:h,handleBlur:r,handleChange:n,errors:a,touched:t,remove:p=>{const d=o.filter((m,f)=>f!==p);l("urlBasedGoogleTagManagerIds",c(d))}},h)),e.jsx("div",{className:"flex flex-wrap justify-end mb-2",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsx(w,{className:"ml-2",type:"primary",size:"sm",label:"+",onClick:()=>i({url:"",tagManagerId:""}),disabled:x,title:"Add Tag Manager Id"})})})]})})})]})}const z={leadCaptureType:"flow",leadCaptureFormMode:"count",showFormAfterChats:3,defaultCountryCode:{countryId:"in",dialCode:"+91"},isWhatsAppEnabled:!1},q=C().shape({urlBasedGoogleTagManagerIds:M().of(C().shape({url:b().trim().required("URL is required"),tagManagerId:b().trim().required("Tag Manager ID is required").matches(/^GTM-[A-Z0-9]+$/,"Format must be GTM-XXXXXX")})),chatReportPropList:M().of(C().shape({label:b().trim().required("Label is required"),prop:b().trim().required("Prop Name is required")}))});function ue(){const s=k(l=>l.isSuperUser),[a,t]=F();if(!t)return null;const{botSettings:r=z}=t||{},n=async(l,{setErrors:x,setStatus:o,setSubmitting:c})=>{try{await D(a,l),o({success:!1}),c(!1),I(!0,"Settings saved successfully!","success")}catch(i){console.error(i),I(!0,"Unable to save settings. Please try again later.","error"),o({success:!1}),x({submit:i.message}),c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"Bot Settings"}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 border rounded-lg shadow bg-white mt-6",children:e.jsx(E,{initialValues:r,onSubmit:n,validationSchema:q,enableReinitialize:!0,children:l=>e.jsx("form",{noValidate:!0,onSubmit:l.handleSubmit,children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(U,{...l}),e.jsx(O,{...l}),e.jsx(_,{...l}),e.jsx(Y,{...l}),s&&e.jsx(G,{...l}),s&&e.jsx(X,{...l}),e.jsx(H,{...l})]})})},a)})]})}function j(s){s.key==="Enter"&&s.preventDefault()}function U({values:s,touched:a,errors:t,handleBlur:r,handleChange:n,setFieldValue:l}){const x=s.leadCaptureType==="form",o=s.leadCaptureType!=="form"||s.leadCaptureFormMode==="keyword",[c,i]=N.useState(s.defaultCountryCode?.countryId||"in"),[g,h]=N.useState(s.defaultCountryCode?.dialCode||"+91");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Lead Capture Settings"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Input Type"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureType",value:"flow",checked:s.leadCaptureType==="flow",onChange:n,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Flow"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureType",value:"form",checked:s.leadCaptureType==="form",onChange:n,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Form"})]})]})]})}),x&&e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"When you want the form to be displayed?"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureFormMode",value:"keyword",checked:s.leadCaptureFormMode==="keyword",onChange:n,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Show form when the keyword matches"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureFormMode",value:"count",checked:s.leadCaptureFormMode==="count",onChange:n,className:"text-blue-600"}),e.jsxs("span",{className:"text-sm flex items-center",children:["Show form after conversations:",e.jsx("input",{type:"text",value:s.showFormAfterChats?.toString(),maxLength:2,className:"w-12 ml-2 px-1 border border-gray-300 rounded text-center",disabled:s.leadCaptureType!=="form"||s.leadCaptureFormMode&&s.leadCaptureFormMode!=="count",onChange:p=>l("showFormAfterChats",T(p.target.value,s.showFormAfterChats)),onKeyDown:j})]})]})]})]})}),!x&&e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Can user proceed without providing contact details?"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:s.leadCaptureFlowMandatory||!1,name:"leadCaptureFlowMandatory",onChange:n,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Make the input mandatory"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:s.isWhatsAppEnabled,name:"isWhatsAppEnabled",onChange:n,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Is WhatsApp Enabled"})]})]})]})}),e.jsx("div",{className:"col-span-12",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Default Phone number country code in contact form"})}),e.jsxs("div",{className:"col-span-12 md:col-span-3 flex items-center",children:[e.jsx(B,{selectedCountry:c,onSelect:({iso2:p,dialCode:d})=>{i(p),l("defaultCountryCode",{countryId:p,dialCode:"+"+d}),h("+"+d)}}),e.jsx("span",{className:"ml-2",children:g})]}),e.jsx("div",{className:"col-span-12",children:e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Number of visitor messages send to GPT for answer",e.jsx("input",{type:"text",value:s.maxChatMessagesToSentToGPT?.toString()||"17",maxLength:2,className:"w-12 ml-2 px-1 border border-gray-300 rounded text-center",onChange:p=>l("maxChatMessagesToSentToGPT",T(p.target.value,s.maxChatMessagesToSentToGPT)),onKeyDown:j})]})}),o&&e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Keywords for Phone Number Collection *"}),e.jsx(P,{name:"phoneNumberKeywords",value:s.phoneNumberKeywords||[],error:!!(a.phoneNumberKeywords&&t.phoneNumberKeywords),onBlur:r,onChange:l,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),a.phoneNumberKeywords&&t.phoneNumberKeywords&&e.jsx("div",{className:"text-red-500 text-sm",children:t.phoneNumberKeywords})]})}),o&&e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Keywords for Email Address Collection *"}),e.jsx(P,{name:"emailKeywords",value:s.emailKeywords||[],error:!!(a.emailKeywords&&t.emailKeywords),onBlur:r,onChange:l,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),a.emailKeywords&&t.emailKeywords&&e.jsx("div",{className:"text-red-500 text-sm",children:t.emailKeywords})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-12 mb-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Validate Contact For Each Chat"}),e.jsx(y,{name:"validateContactForEachChat",value:s.validateContactForEachChat,onChange:(p,d)=>l(p,d),className:"border h-12 rounded-md w-full"})]})})]})}function O({values:s,handleChange:a}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Bot Industry and Role settings"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(u,{label:"Industry",name:"industry",value:s.industry||"",onChange:a,onKeyDown:j})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(u,{label:"Bot Role",name:"botRole",value:s.botRole||"",onChange:a,onKeyDown:j})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(u,{label:"Organization Name",name:"organizationName",value:s.organizationName||"",onChange:a,onKeyDown:j})})]})}function _({values:s,handleChange:a}){const t=k(r=>r.isSuperUser);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Allow / Block chat window"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Allowed IP",name:"allowedIP",value:s.allowedIP||"",onChange:a,placeholder:"Ex: 192.167.22.340, 192.167.22.341",onKeyDown:j})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Denied IP",name:"deniedIP",value:s.deniedIP||"",onChange:a,placeholder:"Ex: 192.167.22.340, 192.167.22.341",onKeyDown:j})}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Allowed Pages",name:"allowedPages",value:s.allowedPages||"",onChange:a,placeholder:"Ex: https://xyz.com, https://abc.com",onKeyDown:j})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Denied Pages",name:"deniedPages",value:s.deniedPages||"",onChange:a,placeholder:"Ex: https://xyz.com, https://abc.com",onKeyDown:j})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Allowed Countries",name:"allowedCountries",value:s.allowedCountries||"",onChange:a,placeholder:"Ex: India, Oman, Australia",onKeyDown:j})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(u,{label:"Denied Countries",name:"deniedCountries",value:s.deniedCountries||"",onChange:a,placeholder:"Ex: Sri Lanka, Bhutan",onKeyDown:j})})]})]})}function Y({values:s,setFieldValue:a}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-span-12",children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Activate Consolidated Leads Reports"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-12 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Daily Consolidated Lead Email"}),e.jsx(y,{name:"sendDailyConsolidatedLeadEmail",value:s.sendDailyConsolidatedLeadEmail,onChange:(t,r)=>a(t,r),className:"border h-12 rounded-md w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Weekly Consolidated Lead Email"}),e.jsx(y,{name:"sendWeeklyConsolidatedLeadEmail",value:s.sendWeeklyConsolidatedLeadEmail,onChange:(t,r)=>a(t,r),className:"border h-12 rounded-md w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Monthly Consolidated Lead Email"}),e.jsx(y,{name:"sendMonthlyConsolidatedLeadEmail",value:s.sendMonthlyConsolidatedLeadEmail,onChange:(t,r)=>a(t,r),className:"border h-12 rounded-md w-full"})]})]})]})})}function H({errors:s,isSubmitting:a}){return e.jsxs(e.Fragment,{children:[s.submit&&e.jsx("div",{className:"col-span-12",children:e.jsx("div",{className:"text-red-500 text-sm",children:s.submit})}),e.jsx("div",{className:"col-span-12 mt-4",children:e.jsx(K,{children:e.jsx(R,{disableElevation:!0,isLoading:a,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",className:"w-full",children:"Save Settings"})})})]})}function T(s,a){if(s)return isNaN(Number(s))?a:Number(s)}function P({name:s,value:a,onChange:t,placeholder:r,inputProps:n,...l}){const x=N.useRef(null),[o,c]=N.useState(""),i=d=>t(s,d),g=d=>{const m=d.target.value;if(c(m),m.endsWith(",")||m.endsWith(" ")){const f=m.replace(/[, ]+$/,"").trim();if(f){const v=[...a,f];i(v),c("")}}},h=d=>{if(d.key==="Enter"||d.key===","){d.preventDefault();const m=o.trim();if(m){const f=[...a,m];i(f),c("")}}else if(d.key==="Backspace"&&!o&&a.length>0){const m=a.slice(0,-1);i(m)}},p=d=>{const m=a.filter((f,v)=>v!==d);i(m)};return e.jsxs("div",{className:"border border-gray-300 rounded-md p-2 flex flex-wrap gap-1 min-h-[40px]",children:[a.map((d,m)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[d,e.jsx("button",{type:"button",onClick:()=>p(m),className:"ml-1 text-blue-600 hover:text-blue-800",children:"Ã—"})]},m)),e.jsx("input",{ref:x,type:"text",value:o,onChange:g,onKeyDown:h,placeholder:a.length===0?r:"",className:"flex-1 min-w-[120px] border-none outline-none bg-transparent",maxLength:n?.maxLength,...l})]})}export{ue as default};
