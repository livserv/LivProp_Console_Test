import{b as r,R as g,f,e as p,r as m,j as i}from"./index-DNgbtrVq.js";import{g as b,r as x,p as S,e as h}from"./ajax-CVEl0eD2.js";import{u as D}from"./useSelectedBot-CzDcn7AF.js";import{S as w}from"./send-BuOAyRFQ.js";import{B as I}from"./Button-CMcgYNbm.js";import"./Button-C3bz2KtR.js";import{a as k,b as j}from"./index-Ds4IBKJg.js";import{F as C}from"./Form-D0ADtdrN.js";async function F(a){const{organizationId:c,selectedBotId:t,kbDocs:e}=r.getState(),o=await b(`/bot/${c}/${t}/knowledge-base/list`);r.setState(s=>({kbDocs:{...s.kbDocs||{},[String(t)]:o}}))}async function B(a){const{organizationId:c,selectedBotId:t}=r.getState(),e=await S(`/bot/${c}/${t}/knowledge-base`,a);return r.setState(o=>{const s={...o.kbDocs||{}},n=s[t];if(!n)return{};if(s[t]=[...n],a._id){const l=s[t].findIndex(u=>u._id===e._id);l>=0?s[t][l]=e:s[t].push(e)}else s[t].push(e);return{kbDocs:s}}),e}async function P(a){const{organizationId:c,selectedBotId:t}=r.getState();await x(`/bot/${c}/${t}/knowledge-base/${a}`,a),r.setState(e=>{var s;const o={...e.kbDocs||{}};return o[t]=(s=o[t])==null?void 0:s.filter(n=>n._id!==a),{kbDocs:o}})}const d=f(()=>({page:1,rowsPerPage:10,totalDocs:0,docsList:[],isLoading:!1}));function _(){const a=r(o=>o.organizationId),[c]=D();g.useEffect(()=>{L()},[c,a]);const t=d(o=>o.docsList),e=d(o=>o.isLoading);return[t,e]}async function L(a=1,c=10){const{organizationId:t}=r.getState(),{selectedBotId:e}=p.getState();if(!t||!e)return;const{botId:o}=d.getState(),s={page:a,rowsPerPage:c,isLoading:!0};o!==e&&(s.docsList=[]),d.setState(s);const n=await h.get(`/bot/${t}/${e}/knowledge-base/list`);d.setState({botId:e,docsList:n,totalDocs:n.length,isLoading:!1})}function A({onDone:a,initial:c}){const[t,e]=m.useState(c||{question:"",content:""}),o=(n,l)=>{e(u=>({...u,[n]:l}))},s=async()=>{await B(t),a()};return i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("div",{className:"font-bold text-lg pb-1 text-center",children:"Add document"}),i.jsxs(C,{value:t,onChange:e,children:[i.jsx(k,{field:"question",placeholder:"Provide title or question for the content",label:"Question",wrapperClassName:"h-6",onChange:n=>o("question",n)}),i.jsx(j,{field:"content",placeholder:"Provide content or answer for the question",label:"Content",className:"h-24",onChange:n=>o("content",n)})]}),i.jsx("div",{className:"text-center",children:i.jsx(I,{icon:i.jsx(w,{}),size:"lg",type:"rounded",onClick:s,className:"bg-[#49d4a1]"})})]})}export{A as E,P as d,F as g,_ as u};
