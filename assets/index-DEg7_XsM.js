import{a as $,b as j,R as i,j as o}from"./index-D9EAXeej.js";import{g as w,f as y}from"./ajax-wCsmuh_l.js";import{a as D,C as v}from"./index-C2Z25x6i.js";import"./env-CmL5wTXD.js";import"./svg-icons-BHnUf74W.js";import"./env-CBDBHzQq.js";function U(){const{organizationId:t,botId:s,recipientId:m,chatId:p}=$(),{isAuthenticated:h}=j(),[r,u]=i.useState(),[a,l]=i.useState(),[,f]=i.useState(),g=`/bot/${t}/${s}/chat/history/${m}/${p}?includeBot=1${h?"&includeKB=1":""}${a!=null&&a.code?`&language=${encodeURIComponent(a.code)}`:""}`;if(i.useEffect(()=>{w(g).then((e=>{var n;const c=y((n=e.messages[0])==null?void 0:n.createdAt);e.botDesign=D(e.botDesign,{window:{width:"600px",height:"calc(100vh - 120px)"},header:{titleText:c+` (${e.titleText})`}}),u(R(e))}),e=>{console.error("Unable to load chat conversations:",e)})},[g]),!r)return o.jsx("div",{children:"Loading... Please wait..."});const x=e=>{const{role:c,type:n,passedDocIds:d,searchQuery:b}=e||{};if(!(c!=="assistant"||n!=="text"||!(d!=null&&d.length)&&!b))return o.jsx("span",{className:"show-icon",onClick:()=>f(e),children:"="})};return o.jsx("div",{className:"conversation-history"+(h?" authenticated":""),children:o.jsx("div",{children:o.jsx(v,{botDesign:r.botDesign,messages:r.messages,showTime:!0,disabledMessage:!0,optionsRenderer:x,language:a,setLanguage:l})})})}function R(t){const s=t.messages.length&&t.messages[t.messages.length-1];return(s==null?void 0:s.type)==="options"&&(s.content=""),t}export{U as default};
