import{a as j,b as w,R as i,j as a}from"./index-CCQKC7kY.js";import{f as D}from"./utils-BxUv4Y9r.js";import{a as v,C}from"./index-D8TIwa1e.js";import{g as R}from"./ajax-DLEL1G7a.js";import"./index-Cr1SGxRI.js";function H(){const{organizationId:t,botId:s,recipientId:l,chatId:m}=j(),{isAuthenticated:h,isSuperUser:u}=w(),[r,p]=i.useState(),[o,f]=i.useState(),[x,b]=i.useState();console.log("ChatHistory selectedMessage",u,x);const g=`/bot/${t}/${s}/chat/history/${l}/${m}?includeBot=1${h?"&includeKB=1":""}${o!=null&&o.code?`&language=${encodeURIComponent(o.code)}`:""}`;if(i.useEffect(()=>{R(g).then(e=>{var n;const c=D((n=e.messages[0])==null?void 0:n.createdAt);e.botDesign=v(e.botDesign,{window:{width:"600px",height:"calc(100vh - 120px)"},header:{titleText:c+` (${e.titleText})`}}),p(S(e))},e=>{console.error("Unable to load chat conversations:",e)})},[g]),!r)return a.jsx("div",{children:"Loading... Please wait..."});const y=e=>{const{role:c,type:n,passedDocIds:d,searchQuery:$}=e||{};if(!(c!=="assistant"||n!=="text"||!(d!=null&&d.length)&&!$))return a.jsx("span",{className:"show-icon",onClick:()=>b(e),children:"="})};return a.jsx("div",{className:"conversation-history"+(h?" authenticated":""),children:a.jsx("div",{children:a.jsx(C,{botDesign:r.botDesign,messages:r.messages,showTime:!0,disabledMessage:!0,optionsRenderer:y,language:o,setLanguage:f})})})}function S(t){const s=t.messages.length&&t.messages[t.messages.length-1];return(s==null?void 0:s.type)==="options"&&(s.content=""),t}export{H as default};
