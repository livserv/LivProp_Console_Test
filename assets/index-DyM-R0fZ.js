import{g as C,c as v,R as i,r as R,j as s}from"./AlertSnackbar-BBOi9bHj.js";import{g as I,j as B}from"./index-Bc6GgoYM.js";import{a as M,C as S,K as V}from"./KbDocsEditor-DfpjQhzX.js";import"./env-CmL5wTXD.js";import"./svg-icons-edwjkgHn.js";import"./env-CBDBHzQq.js";import"./Button-htJsKnEd.js";import"./index-CVdVTGYS.js";import"./KbDocsList-D75dQTyg.js";import"./delete-BYa5uglT.js";import"./edit-B3Se8WZw.js";import"./plus-MhxGst-q.js";import"./Button-0e94RQCV.js";import"./SelectBox-fJycAsWQ.js";import"./TextBox-CgrWamRX.js";import"./utils-BPLOM7gE.js";import"./useSelectedBot-D0BiDtF-.js";import"./bots-BH5QNpTb.js";import"./PageHeader-XpWP1bl8.js";import"./organization-B2CtXnOf.js";import"./send-DIJqnNt5.js";import"./index-B5AMxe6e.js";import"./ProgressButton-DbRXTBvR.js";function at(e){const o=C(),n=e.organizationId??o.organizationId,r=e.botId??o.botId,c=e.recipientId??o.recipientId,d=e.chatId??o.chatId,{isSuperUser:b}=v(),{isAuthenticated:l}=v(),[m,f]=i.useState(),[h,$]=i.useState(),[g,u]=R.useState(null),x=`/bot/${n}/${r}/chat/history/${c}/${d}?includeBot=1${l?"&includeKB=1":""}${h?.code?`&language=${encodeURIComponent(h.code)}`:""}`;i.useEffect(()=>{I(x).then(t=>{const a=B(t.messages[0]?.createdAt);t.botDesign=M(t.botDesign,{window:{width:"600px",height:"calc(100vh - 120px)"},header:{titleText:a+` (${t.titleText})`}}),f(A(t))},t=>{console.error("Unable to load chat conversations:",t)})},[x]);const y=i.useCallback(async(t,a)=>{const p=await I(`/bot/${n}/${r}/chat/history/${c}/${d}/replay/${t}?modelName=${a||""}`);u(p)},[n,r,c,d]);if(!m)return s.jsx("div",{children:"Loading... Please wait..."});const j=t=>{const{role:a,type:p,passedDocIds:w,searchQuery:z}=t||{};if(a!=="assistant"||p!=="text"||!w?.length&&!z)return null;const H=()=>s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:s.jsx("path",{d:"M19 2H8c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h11c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 17H8V4h11v15zm-2-7H10v2h7v-2zm0-4H10v2h7V8zm-9 9H5V5c0-1.1.9-2 2-2h1v2H7v12zm0 2v-2h1v2H7z"})});return s.jsx("span",{className:"ml-2 cursor-pointer",onClick:()=>D(t),children:s.jsx(H,{})})},D=t=>{u(t)};return s.jsxs("div",{className:"conversation-history"+(l?" authenticated":""),children:[s.jsx("div",{children:s.jsx(S,{botDesign:m.botDesign,messages:m.messages,showTime:!0,disabledMessage:!0,optionsRenderer:j,language:h,setLanguage:$,activateVoiceBot:!1})}),g&&s.jsx(V,{message:g,isSuperUser:b,onReplay:y})]})}function A(e){const o=e.messages.length&&e.messages[e.messages.length-1];return o?.type==="options"&&(o.content=""),e}export{at as default};
