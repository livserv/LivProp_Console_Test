import{R as p,j as b}from"./index-DeVpdhnv.js";import{P as $}from"./index-eerg1Ypx.js";import{h as j,i as v}from"./ajax-DrXfQpOo.js";function K(c,r){const s={hasError:!1};if(!c)return s;try{const g=c.validateSync(r,{abortEarly:!1});console.log(g)}catch(g){const t=g.inner;s.hasError=!0,s.errors=t.reduce((e,o)=>(e[o.path]=o.message,e),{})}return s}function x(c){const r=p.useRef({props:c,touched:{}});r.current.props=c,r.current.errors=c.errors||r.current.errors;const{value:s}=c,g=p.useMemo(()=>({onChange:(t,e,o)=>{const{field:i,args:u,middleware:n,onChange:l,validator:f}=r.current.props,d=i?`${i}.${e}`:e,a=j(s,d,n?n(t,e,!0):t),h=K(f,a);r.current.errors=h,r.current.touched[e]=!0,l(a,i,{fieldArgs:o,field:e,args:u,errors:h})},getProps:(t,e)=>{var a,h;const{field:o,middleware:i}=r.current.props,{valueFieldProp:u="value"}=e||{},{field:n,[u]:l}=t;if(!n)return{[u]:l};const f=o?`${o}.${n}`:n,d=(h=(a=r.current.errors)==null?void 0:a.errors)==null?void 0:h[n];return{[u]:v(s,f),hasError:!!d,isTouched:r.current.touched[n],middleware:i,errorMessage:d}},setValue:(t,e)=>{if(!t||typeof t!="object")return;const{field:o,args:i,middleware:u,onChange:n,validator:l}=r.current.props,f=Object.keys(t);if(!f.length)return;const d=f.reduce((h,m)=>{const y=t[m],E=o?`${o}.${m}`:m;return j(h,E,u?u(y,m,!0):y)},s),a=l==null?void 0:l.validate(d);r.current.errors=a,n(d,o,{fieldArgs:e,args:i,errors:a})},getErrors:()=>r.current.errors}),[s]);return b.jsx($,{value:g,children:c.children})}export{x as F};
