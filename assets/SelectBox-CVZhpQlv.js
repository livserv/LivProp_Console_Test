import{r as s,j as r}from"./AlertSnackbar-Bg-JJn4T.js";import{c as m}from"./index-B48b7GnV.js";import{R as $}from"./Button-NNSQHuwk.js";import{L as T}from"./LabelWrapper-D8qjrIKZ.js";function Q({label:N,placeholder:R="Choose here...",options:c=[],showFilter:g=c.length>10,showClear:P=!0,onChange:y=()=>{},value:n,className:C,multiple:l=!1}){const[a,v]=s.useState(!1),[k,j]=s.useState(""),[o,d]=s.useState(-1),[f,O]=s.useState(null),w=s.useRef(null),E=s.useRef(null),u=s.useRef(null),D=s.useRef(null),i=k?c.filter(e=>e.label!=null&&e.label.toString().toLowerCase().includes(k.toLowerCase())):c,H=c.find(e=>e.value===n),B=()=>v(e=>!e),p=()=>{v(!1),j(""),d(-1)},A=e=>l&&Array.isArray(n)?n.includes(e):n===e,h=e=>{if(l){let t=Array.isArray(n)?[...n]:[];t.includes(e.value)?t=t.filter(x=>x!==e.value):t.push(e.value),y(t)}else y(e.value),p()},z=e=>{e.stopPropagation(),y(l?[]:null)},I=e=>{e.stopPropagation(),u.current&&document.activeElement!==u.current&&u.current.focus()},K=e=>{e.stopPropagation(),d(-1)},M=()=>{if(l&&Array.isArray(n))return n.length===0?r.jsx("span",{className:"text-gray-400",children:R}):r.jsx("span",{children:c.filter(t=>n.includes(t.value)).map(t=>r.jsx("span",{className:"inline-block bg-gray-200 rounded px-2 py-1 mr-1 text-xs",children:t.label},t.value))});const e=c.find(t=>t.value===n);return e?e.label:r.jsx("span",{className:"text-gray-400",children:R})},L=()=>{if(w.current){const e=w.current.getBoundingClientRect(),t=200,x=window.innerHeight-e.bottom,F=e.top,b=x<t&&F>t,V=window.innerWidth<=640?window.innerWidth*.9:e.width,Y=window.innerWidth<=640?window.innerHeight*.8:b?F:x;O({top:b?e.top-(b?t:0)+window.scrollY:e.bottom+window.scrollY,left:window.innerWidth<=640?window.innerWidth*.05:e.left+window.scrollX,maxHeight:Y,width:V,dropUp:b})}};s.useEffect(()=>{const e=t=>{w.current&&!w.current.contains(t.target)&&D.current&&!D.current.contains(t.target)&&p()};return a?(document.addEventListener("mousedown",e),L(),d(-1),g&&u.current&&setTimeout(()=>{u.current?.focus()},10)):(document.removeEventListener("mousedown",e),j("")),()=>{document.removeEventListener("mousedown",e)}},[a,g]),s.useEffect(()=>{const e=()=>{a&&L()};return window.addEventListener("resize",e),window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e,!0)}},[a]),s.useEffect(()=>{if(o>=0&&E.current){const t=E.current.children[o];t&&t.scrollIntoView({block:"nearest"})}},[o]);const S=e=>{if(!a){(e.key==="ArrowDown"||e.key==="Enter")&&(v(!0),e.preventDefault());return}switch(e.key){case"ArrowDown":d(t=>Math.min(t+1,i.length-1)),e.preventDefault();break;case"ArrowUp":d(t=>Math.max(t-1,0)),e.preventDefault();break;case"Enter":o>=0&&o<i.length&&h(i[o]),e.preventDefault();break;case"Escape":p(),e.preventDefault();break}},U=e=>{e.key==="ArrowDown"||e.key==="ArrowUp"?S(e):e.key==="Enter"?i.length===1?(h(i[0]),e.preventDefault()):o>=0&&o<i.length&&(h(i[o]),e.preventDefault()):e.key==="Escape"&&(p(),e.preventDefault())},W=r.jsxs(r.Fragment,{children:[r.jsxs("div",{ref:w,className:m("flex items-center justify-between cursor-pointer mt-[-4px]",!/h-\[?.*?\]?/g.test(C||"")&&"h-full w-full min-w-[100px] md:min-w-[150px]",C),onClick:B,onKeyDown:S,tabIndex:0,"aria-haspopup":"listbox","aria-expanded":a,children:[r.jsx("span",{className:m("flex-1 px-4 text-sm",l&&Array.isArray(n)&&n.length>0||H?"text-black":"text-pBlack"),children:M()}),P&&(l&&Array.isArray(n)&&n.length>0||!l&&n)&&r.jsx("button",{onClick:z,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Clear selection",children:"Ã—"}),r.jsx("div",{className:"w-0 h-0 me-3 border-t-[6px] border-b-0 border-l-[3.5px] border-r-[3.5px] border-transparent border-t-labelBlue"})]}),a&&f&&$.createPortal(r.jsxs("div",{ref:D,className:m("absolute z-[11020] bg-white border border-gray-300 rounded shadow-lg",window.innerWidth<=640?"fixed top-0 left-0 right-0 bottom-0 m-auto":""),style:{top:window.innerWidth<=640?"10%":f.top,left:window.innerWidth<=640?"5%":f.left,width:window.innerWidth<=640?"90%":f.width,maxHeight:window.innerWidth<=640?"80%":f.maxHeight,overflow:"auto"},role:"listbox","aria-activedescendant":o>=0?`selectbox-option-${o}`:void 0,children:[g&&r.jsx("div",{className:"p-2 border-b border-gray-200",children:r.jsx("input",{ref:u,type:"text",value:k,onChange:e=>j(e.target.value),onClick:I,onFocus:K,onKeyDown:U,className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",placeholder:"Filter...","aria-label":"Filter options"})}),r.jsx("div",{className:"max-h-60 overflow-auto",ref:E,role:"presentation",children:i.length>0?i.map((e,t)=>r.jsxs("div",{id:`selectbox-option-${t}`,onClick:()=>h(e),onMouseEnter:()=>d(t),className:m("px-4 py-2 cursor-pointer text-black text-xs",A(e.value)?"bg-blue-500 text-white":"",o===t?"bg-gray-200":"","border-b border-gray-100 last:border-b-0"),role:"option","aria-selected":A(e.value),children:[l&&r.jsx("input",{type:"checkbox",checked:A(e.value),readOnly:!0,className:"mr-2"}),e.label]},e.value)):r.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No options found"})})]}),document.body)]});return N?r.jsx(T,{label:N,children:W}):W}export{Q as S};
