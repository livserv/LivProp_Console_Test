import{r as o,j as r}from"./index-DilKqAPQ.js";import{c as x}from"./Button-DRd7mco0.js";import{R as K}from"./ajax-rKymc6Ns.js";import{L as V}from"./LabelWrapper-Clfai9mb.js";function q({label:E,placeholder:N="Choose here...",options:l=[],showFilter:A=l.length>10,showClear:C=!0,onChange:b=()=>{},value:n,className:D,multiple:a=!1}){const[s,m]=o.useState(!1),[g,y]=o.useState(""),[i,c]=o.useState(-1),[d,O]=o.useState(null),u=o.useRef(null),f=o.useRef(null),v=o.useRef(null),w=g?l.filter(e=>e.label.toString().toLowerCase().includes(g.toLowerCase())):l,P=l.find(e=>e.value===n),H=()=>m(e=>!e),j=()=>{m(!1),y(""),c(-1)},k=e=>a&&Array.isArray(n)?n.includes(e):n===e,L=e=>{if(a){let t=Array.isArray(n)?[...n]:[];t.includes(e.value)?t=t.filter(h=>h!==e.value):t.push(e.value),b(t)}else b(e.value),j()},B=e=>{e.stopPropagation(),b(a?[]:null)},z=()=>{if(a&&Array.isArray(n))return n.length===0?r.jsx("span",{className:"text-gray-400",children:N}):r.jsx("span",{children:l.filter(t=>n.includes(t.value)).map(t=>r.jsx("span",{className:"inline-block bg-gray-200 rounded px-2 py-1 mr-1 text-xs",children:t.label},t.value))});const e=l.find(t=>t.value===n);return e?e.label:r.jsx("span",{className:"text-gray-400",children:N})},R=()=>{if(u.current){const e=u.current.getBoundingClientRect(),t=200,h=window.innerHeight-e.bottom,W=e.top,p=h<t&&W>t,I=window.innerWidth<=640?window.innerWidth*.9:e.width,M=window.innerWidth<=640?window.innerHeight*.8:p?W:h;O({top:p?e.top-(p?t:0)+window.scrollY:e.bottom+window.scrollY,left:window.innerWidth<=640?window.innerWidth*.05:e.left+window.scrollX,maxHeight:M,width:I,dropUp:p})}};o.useEffect(()=>{const e=t=>{u.current&&!u.current.contains(t.target)&&f.current&&!f.current.contains(t.target)&&j()};return s?(document.addEventListener("mousedown",e),R(),c(-1)):(document.removeEventListener("mousedown",e),y("")),()=>{document.removeEventListener("mousedown",e)}},[s]),o.useEffect(()=>{const e=()=>{s&&R()};return window.addEventListener("resize",e),window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e,!0)}},[s]),o.useEffect(()=>{s&&v.current&&v.current.focus()},[s,A]),o.useEffect(()=>{if(i>=0&&f.current){const t=f.current.children[i];t&&t.scrollIntoView({block:"nearest"})}},[i]);const F=e=>{if(!s){(e.key==="ArrowDown"||e.key==="Enter")&&(m(!0),e.preventDefault());return}switch(e.key){case"ArrowDown":c(t=>Math.min(t+1,w.length-1)),e.preventDefault();break;case"ArrowUp":c(t=>Math.max(t-1,0)),e.preventDefault();break;case"Enter":i>=0&&i<w.length&&L(w[i]),e.preventDefault();break;case"Escape":j(),e.preventDefault();break}},S=r.jsxs(r.Fragment,{children:[r.jsxs("div",{ref:u,className:x("flex items-center justify-between cursor-pointer mt-[-4px]",!/h-\[?.*?\]?/g.test(D||"")&&"h-full w-full",D),onClick:H,onKeyDown:F,tabIndex:0,"aria-haspopup":"listbox","aria-expanded":s,children:[r.jsx("span",{className:x("flex-1 px-4 text-sm",a&&Array.isArray(n)&&n.length>0||P?"text-black":"text-pBlack"),children:z()}),C&&(a&&Array.isArray(n)&&n.length>0||!a&&n)&&r.jsx("button",{onClick:B,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Clear selection",children:"Ã—"}),r.jsx("div",{className:"w-0 h-0 me-3 border-t-[6px] border-b-0 border-l-[3.5px] border-r-[3.5px] border-transparent border-t-labelBlue"})]}),s&&d&&K.createPortal(r.jsxs("div",{className:x("absolute z-50 bg-white border border-gray-300 rounded shadow-lg",window.innerWidth<=640?"fixed top-0 left-0 right-0 bottom-0 m-auto":""),style:{top:window.innerWidth<=640?"10%":d.top,left:window.innerWidth<=640?"5%":d.left,width:window.innerWidth<=640?"90%":d.width,maxHeight:window.innerWidth<=640?"80%":d.maxHeight,overflow:"auto"},role:"listbox","aria-activedescendant":i>=0?`selectbox-option-${i}`:void 0,children:[A&&r.jsx("div",{className:"p-2 border-b border-gray-200",children:r.jsx("input",{ref:v,type:"text",value:g,onChange:e=>y(e.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring bg-white",placeholder:"Filter...",onKeyDown:e=>e.stopPropagation(),"aria-label":"Filter options"})}),r.jsx("div",{className:"max-h-60 overflow-auto",ref:f,role:"presentation",children:w.length>0?w.map((e,t)=>r.jsxs("div",{id:`selectbox-option-${t}`,onClick:()=>L(e),onMouseEnter:()=>c(t),className:x("px-4 py-2 cursor-pointer text-black text-xs",k(e.value)?"bg-blue-500 text-white":"",i===t?"bg-gray-200":"","border-b border-gray-100 last:border-b-0"),role:"option","aria-selected":k(e.value),children:[a&&r.jsx("input",{type:"checkbox",checked:k(e.value),readOnly:!0,className:"mr-2"}),e.label]},e.value)):r.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No options found"})})]}),document.body)]});return E?r.jsx(V,{label:E,children:S}):S}export{q as S};
