import{j as e,h as v,p as fe,m as xe,r as K,c as V,u as be,R as he}from"./AlertSnackbar-BBOi9bHj.js";import{F as q,a as ye}from"./formik.esm-WsGY0UtP.js";import{c as D,a as T,d as re,e as O,f as ge,g as Ne}from"./index.esm-DQc3wIMG.js";import{B as C}from"./Button-Cjbknt0d.js";import{o as ve,c as Q}from"./index-CUzqN5ta.js";import"./Button-htJsKnEd.js";import{T as w}from"./TextBox-vTD9KzNe.js";import{a as Ce,b as oe,d as je,g as we}from"./integrations-3YPWjTX9.js";import{w as ne}from"./env-CBDBHzQq.js";import{P as ke}from"./ProgressButton-DbRXTBvR.js";import{w as Y}from"./env-CmL5wTXD.js";import{s as R}from"./utils-BPLOM7gE.js";import{C as H,S as Ie}from"./ConfirmDialog-BWUFHem8.js";import{b as Te}from"./organization-4CNJ-QOP.js";import{S as Ue}from"./cancel-BJIo1xsA.js";import{S as Se}from"./plus-MhxGst-q.js";import{S as ee}from"./whatsapp-v2h0oA3q.js";import{u as Pe}from"./useSelectedBot-D0BiDtF-.js";import{P as De}from"./PageHeader-BsmArPDS.js";import"./LabelWrapper-C5GcLzYW.js";import"./SelectBox-zddttI4M.js";function ie({botId:t,organizationId:s,setPopUpDialog:b}){const m=async(i,{setErrors:u,setStatus:n,setSubmitting:a})=>{try{const d={botId:t,organizationId:s,callbackURL:i.crmCallBackUrl,channelId:"CRM_Callback_123",channelName:"CRM_Callback"};await Ce(d),n({success:!0}),a(!0),b(!1),v(!0,"The CRM callback url added successfully!","success")}catch(d){n({success:!1}),u({submit:d.message}),a(!1),v(!0,"Not able to CRM callback url. Try after sometime!","error")}};return e.jsx("div",{className:"w-full",children:e.jsx(q,{initialValues:{crmCallBackUrl:"",submit:""},validationSchema:D().shape({crmCallBackUrl:T().url("Enter valid url!").required("CRM Callback URL is required"),submit:T()}),onSubmit:m,children:({errors:i,handleBlur:u,handleChange:n,handleSubmit:a,isSubmitting:d,touched:c,values:g})=>e.jsxs("form",{noValidate:!0,onSubmit:a,children:[e.jsxs("div",{className:"mt-4",children:[e.jsx(w,{label:"CRM callback URL",id:"crmCallBackUrl",type:"url",name:"crmCallBackUrl",value:g.crmCallBackUrl,onBlur:u,onChange:n,autoComplete:"off",className:c.crmCallBackUrl&&i.crmCallBackUrl?"border-red-500":""}),c.crmCallBackUrl&&i.crmCallBackUrl&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:i.crmCallBackUrl})]}),i.submit&&e.jsx("div",{className:"text-red-600 text-xs mb-2",children:i.submit}),e.jsx("div",{className:"flex justify-end",children:e.jsx(C,{disabled:d,isLoading:d,htmlType:"submit",type:"primary",size:"lg",label:d?"Adding...":"Add"})})]})})})}var A={},z,ae;function Re(){return ae||(ae=1,z=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var s=document.activeElement,b=[],m=0;m<t.rangeCount;m++)b.push(t.getRangeAt(m));switch(s.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":s.blur();break;default:s=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||b.forEach(function(i){t.addRange(i)}),s&&s.focus()}}),z}var M,te;function Ae(){if(te)return M;te=1;var t=Re(),s={"text/plain":"Text","text/html":"Url",default:"Text"},b="Copy to clipboard: #{key}, Enter";function m(u){var n=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return u.replace(/#{\s*key\s*}/g,n)}function i(u,n){var a,d,c,g,h,r,y=!1;n||(n={}),a=n.debug||!1;try{c=t(),g=document.createRange(),h=document.getSelection(),r=document.createElement("span"),r.textContent=u,r.ariaHidden="true",r.style.all="unset",r.style.position="fixed",r.style.top=0,r.style.clip="rect(0, 0, 0, 0)",r.style.whiteSpace="pre",r.style.webkitUserSelect="text",r.style.MozUserSelect="text",r.style.msUserSelect="text",r.style.userSelect="text",r.addEventListener("copy",function(f){if(f.stopPropagation(),n.format)if(f.preventDefault(),typeof f.clipboardData>"u"){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var k=s[n.format]||s.default;window.clipboardData.setData(k,u)}else f.clipboardData.clearData(),f.clipboardData.setData(n.format,u);n.onCopy&&(f.preventDefault(),n.onCopy(f.clipboardData))}),document.body.appendChild(r),g.selectNodeContents(r),h.addRange(g);var I=document.execCommand("copy");if(!I)throw new Error("copy command was unsuccessful");y=!0}catch(f){a&&console.error("unable to copy using execCommand: ",f),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",u),n.onCopy&&n.onCopy(window.clipboardData),y=!0}catch(k){a&&console.error("unable to copy using clipboardData: ",k),a&&console.error("falling back to prompt"),d=m("message"in n?n.message:b),window.prompt(d,u)}}finally{h&&(typeof h.removeRange=="function"?h.removeRange(g):h.removeAllRanges()),r&&document.body.removeChild(r),c()}return y}return M=i,M}var se;function _e(){if(se)return A;se=1;function t(l){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},t(l)}Object.defineProperty(A,"__esModule",{value:!0}),A.CopyToClipboard=void 0;var s=i(fe()),b=i(Ae()),m=["text","onCopy","options","children"];function i(l){return l&&l.__esModule?l:{default:l}}function u(l,o){var x=Object.keys(l);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(l);o&&(p=p.filter(function(N){return Object.getOwnPropertyDescriptor(l,N).enumerable})),x.push.apply(x,p)}return x}function n(l){for(var o=1;o<arguments.length;o++){var x=arguments[o]!=null?arguments[o]:{};o%2?u(Object(x),!0).forEach(function(p){S(l,p,x[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(x)):u(Object(x)).forEach(function(p){Object.defineProperty(l,p,Object.getOwnPropertyDescriptor(x,p))})}return l}function a(l,o){if(l==null)return{};var x=d(l,o),p,N;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(l);for(N=0;N<j.length;N++)p=j[N],!(o.indexOf(p)>=0)&&Object.prototype.propertyIsEnumerable.call(l,p)&&(x[p]=l[p])}return x}function d(l,o){if(l==null)return{};var x={},p=Object.keys(l),N,j;for(j=0;j<p.length;j++)N=p[j],!(o.indexOf(N)>=0)&&(x[N]=l[N]);return x}function c(l,o){if(!(l instanceof o))throw new TypeError("Cannot call a class as a function")}function g(l,o){for(var x=0;x<o.length;x++){var p=o[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(l,p.key,p)}}function h(l,o,x){return o&&g(l.prototype,o),Object.defineProperty(l,"prototype",{writable:!1}),l}function r(l,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(o&&o.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),o&&y(l,o)}function y(l,o){return y=Object.setPrototypeOf||function(p,N){return p.__proto__=N,p},y(l,o)}function I(l){var o=W();return function(){var p=U(l),N;if(o){var j=U(this).constructor;N=Reflect.construct(p,arguments,j)}else N=p.apply(this,arguments);return f(this,N)}}function f(l,o){if(o&&(t(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k(l)}function k(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function W(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function U(l){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)},U(l)}function S(l,o,x){return o in l?Object.defineProperty(l,o,{value:x,enumerable:!0,configurable:!0,writable:!0}):l[o]=x,l}var _=(function(l){r(x,l);var o=I(x);function x(){var p;c(this,x);for(var N=arguments.length,j=new Array(N),P=0;P<N;P++)j[P]=arguments[P];return p=o.call.apply(o,[this].concat(j)),S(k(p),"onClick",function(F){var E=p.props,Z=E.text,J=E.onCopy,me=E.children,pe=E.options,L=s.default.Children.only(me),ue=(0,b.default)(Z,pe);J&&J(Z,ue),L&&L.props&&typeof L.props.onClick=="function"&&L.props.onClick(F)}),p}return h(x,[{key:"render",value:function(){var N=this.props;N.text,N.onCopy,N.options;var j=N.children,P=a(N,m),F=s.default.Children.only(j);return s.default.cloneElement(F,n(n({},P),{},{onClick:this.onClick}))}}]),x})(s.default.PureComponent);return A.CopyToClipboard=_,S(_,"defaultProps",{onCopy:void 0,options:void 0}),A}var G,le;function Ee(){if(le)return G;le=1;var t=_e(),s=t.CopyToClipboard;return s.CopyToClipboard=s,G=s,G}var B=Ee();const X=xe(B);function de({botId:t,organizationId:s,setPopUpDialog:b,gupshupIntegrationObj:m,edit:i}){const u=async(a,{setErrors:d,setStatus:c,setSubmitting:g})=>{try{let h=a;const r=m?._id;m&&(h={...a,objId:r}),await oe(h),c({success:!0}),g(!0),b(!1),v(!0,"The Gupshup integration added successfully!","success")}catch(h){c({success:!1}),d({submit:h.message}),g(!1),v(!0,"Not able to activate Gupshup integration. Try after sometime!","error")}};function n(a){a.key==="Enter"&&a.preventDefault()}return e.jsx("div",{className:"w-full",children:e.jsx(q,{initialValues:{webHookUrl:`${ne}/gupshup/${s}/${t}/entrypoint`,appId:m?.appId||"",appName:m?.appName||"",phoneNumberId:m?.phoneNumberId||"",channelId:"gupshup_123",channelName:"gupshup",leadCategory:m?.leadCategory||"preSale",leadUpgradeToPreSaleCount:m?.leadUpgradeToPreSaleCount||"",submit:""},validationSchema:D().shape({appId:T().required("App ID is required"),appName:T().required("App name is required"),phoneNumberId:O().min(10,"Please enter a valid phone number id").required("Phone number is required"),leadUpgradeToPreSaleCount:re().test("is-null-or-positive","Categorize to Presale after no of conversations must be greater than 0",a=>a==null||typeof a=="number"&&a>0)}),onSubmit:u,children:({errors:a,handleBlur:d,handleChange:c,handleSubmit:g,isSubmitting:h,touched:r,values:y})=>e.jsxs("form",{noValidate:!0,onSubmit:g,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"webHookUrl",children:"Gupshup Callback URL *"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{text:y.webHookUrl,onCopy:()=>v(!0,"Webhook Callback URL copied to clipboard","success"),children:e.jsx("input",{id:"webHookUrl",type:"url",value:y.webHookUrl,name:"webHookUrl",onBlur:d,onChange:c,autoComplete:"off",disabled:!0,onKeyDown:n,className:"w-full border rounded px-3 py-2 bg-gray-100"})})}),r.webHookUrl&&a.webHookUrl&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.webHookUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"appId",children:"Gupshup App ID *"}),e.jsx(w,{id:"appId",name:"appId",value:y.appId,onBlur:d,onChange:I=>c(I.target.value),autoComplete:"off",onKeyDown:n,className:r.appId&&a.appId?"border-red-500":""}),r.appId&&a.appId&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:typeof a.appId=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.appId})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"appName",children:"Gupshup App Name *"}),e.jsx(w,{id:"appName",name:"appName",value:y.appName,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.appName&&a.appName?"border-red-500":""}),r.appName&&a.appName&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:typeof a.submit=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.submit})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"phoneNumberId",children:"Phone Number *"}),e.jsx(w,{id:"phoneNumberId",name:"phoneNumberId",type:"number",value:y.phoneNumberId,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.phoneNumberId&&a.phoneNumberId?"border-red-500":""}),r.phoneNumberId&&a.phoneNumberId&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:typeof a.phoneNumberId=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.phoneNumberId})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"leadCategory",children:"Initial Lead Category"}),e.jsxs("select",{id:"leadCategory",name:"leadCategory",value:y.leadCategory||"preSale",onBlur:d,onChange:c,className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"preSale",children:"Presale"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"others",children:"Others"})]}),r.leadCategory&&a.leadCategory&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:typeof a.leadCategory=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.leadCategory})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"leadUpgradeToPreSaleCount",children:"Categorize to Presale after conversations"}),e.jsx(w,{id:"leadUpgradeToPreSaleCount",name:"leadUpgradeToPreSaleCount",value:y.leadUpgradeToPreSaleCount,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.leadUpgradeToPreSaleCount&&a.leadUpgradeToPreSaleCount?"border-red-500":""}),r.leadUpgradeToPreSaleCount&&a.leadUpgradeToPreSaleCount&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:typeof a.leadUpgradeToPreSaleCount=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.leadUpgradeToPreSaleCount})})]})]}),a.submit&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.submit}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(C,{disabled:h,isLoading:h,htmlType:"submit",type:"primary",size:"lg",label:i?"Edit":"Add"})})]})})})}function Le(t,s){return btoa(`${t}_${s}_whatsapp_int`)}function ce({botId:t,organizationId:s,setPopUpDialog:b,whatsappIntegrationObj:m,edit:i}){const u=async(a,{setErrors:d,setStatus:c,setSubmitting:g})=>{try{let h=a;const r=m?._id;r&&(h={...a,objId:r}),await oe(h),c({success:!0}),g(!0),b(!1),v(!0,"The WhatsApp integration added successfully!","success")}catch(h){c({success:!1}),d({submit:h.message}),g(!1),v(!0,"Not able to activate WhatsApp integration. Try after sometime!","error")}};function n(a){a.key==="Enter"&&a.preventDefault()}return e.jsx("div",{className:"w-full",children:e.jsx(q,{initialValues:{webHookUrl:`${ne}/whatsapp/${s}/${t}/entrypoint`,webHookSecret:Le(s,t),appId:m?.appId||"",appName:m?.appName||"",phoneNumberId:m?.phoneNumberId||"",verificationToken:m?.verificationToken||"",channelId:"whatsapp_123",channelName:"whatsapp",leadCategory:m?.leadCategory||"preSale",leadUpgradeToPreSaleCount:m?.leadUpgradeToPreSaleCount||"",submit:""},validationSchema:D().shape({appId:O().required("App ID must be a number"),appName:T().required("App name is required"),phoneNumberId:O().min(10,"Please enter a valid phone number id").required("Phone number is required"),verificationToken:T().required("Access Token  is required"),leadUpgradeToPreSaleCount:re().test("is-null-or-positive","Categorize to Presale after no of conversations must be greater than 0",a=>a==null||!isNaN(Number(a))&&Number(a)>0)}),onSubmit:u,children:({errors:a,handleBlur:d,handleChange:c,handleSubmit:g,isSubmitting:h,touched:r,values:y})=>e.jsxs("form",{noValidate:!0,onSubmit:g,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"webHookUrl",children:"Webhook Callback URL *"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{text:y.webHookUrl,onCopy:()=>v(!0,"Webhook Callback URL copied to clipboard","success"),children:e.jsx("input",{id:"webHookUrl",type:"url",value:y.webHookUrl,name:"webHookUrl",onBlur:d,onChange:c,autoComplete:"off",disabled:!0,onKeyDown:n,className:"w-full border rounded px-3 py-2 bg-gray-100"})})}),r.webHookUrl&&a.webHookUrl&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.webHookUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"webHookSecret",children:"Webhook Verify token *"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{text:y.webHookSecret,onCopy:()=>v(!0,"Webhook Verify Token copied to clipboard","success"),children:e.jsx("input",{id:"webHookSecret",type:"text",value:y.webHookSecret,name:"webHookSecret",onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:"w-full border rounded px-3 py-2 bg-gray-100",disabled:!0})})}),r.webHookSecret&&a.webHookSecret&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.webHookSecret})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"appId",children:"App ID *"}),e.jsx(w,{id:"appId",name:"appId",value:y.appId,onBlur:d,onChange:c,onKeyDown:n,className:r.appId&&a.appId?"border-red-500":""}),r.appId&&a.appId&&typeof a.appId=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.appId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"appName",children:"App Name *"}),e.jsx(w,{id:"appName",name:"appName",value:y.appName,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.appName&&a.appName?"border-red-500":""}),r.appName&&a.appName&&a.appName==="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.appName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"phoneNumberId",children:"Phone Number ID *"}),e.jsx(w,{id:"phoneNumberId",name:"phoneNumberId",type:"text",value:y.phoneNumberId,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.phoneNumberId&&a.phoneNumberId?"border-red-500":""}),r.phoneNumberId&&a.phoneNumberId&&a.phoneNumberId==="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.phoneNumberId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"verificationToken",children:"Access Token *"}),e.jsx(w,{id:"verificationToken",name:"verificationToken",type:"text",value:y.verificationToken,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.verificationToken&&a.verificationToken?"border-red-500":""}),r.verificationToken&&a.verificationToken&&typeof a.verificationToken=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.verificationToken})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"leadCategory",children:"Initial Lead Category"}),e.jsxs("select",{id:"leadCategory",name:"leadCategory",value:y.leadCategory||"preSale",onBlur:d,onChange:c,className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"preSale",children:"Presale"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"others",children:"Others"})]}),r.leadCategory&&a.leadCategory&&typeof a.leadCategory=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.leadCategory})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",htmlFor:"leadUpgradeToPreSaleCount",children:"Categorize to Presale after conversations"}),e.jsx(w,{id:"leadUpgradeToPreSaleCount",name:"leadUpgradeToPreSaleCount",value:y.leadUpgradeToPreSaleCount,onBlur:d,onChange:c,autoComplete:"off",onKeyDown:n,className:r.leadUpgradeToPreSaleCount&&a.leadUpgradeToPreSaleCount?"border-red-500":""}),r.leadUpgradeToPreSaleCount&&a.leadUpgradeToPreSaleCount&&a.leadUpgradeToPreSaleCount==="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:a.leadUpgradeToPreSaleCount})]})]}),typeof a.submit=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.submit}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(ke,{isLoading:h,disabled:h,type:"submit",children:i?"Edit":"Add"})})]})})})}function $({label:t,value:s,copyText:b,onCopy:m}){return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 my-3",children:[e.jsx("b",{className:"sm:min-w-[180px] text-sm sm:text-base",children:t}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap flex-1 font-mono text-xs sm:text-sm",title:s,children:s}),e.jsx(B.CopyToClipboard,{text:b||s,onCopy:m,children:e.jsx(C,{label:"Copy",type:"primary",style:{minWidth:60}})})]})]})}function $e({integrationObj:t}){const[s,b]=K.useState(!1),[m,i]=K.useState(!1),u=async(d,c)=>{try{await je(d),v(!0,`The ${c} deleted successfully!`,"success")}catch{v(!0,`Not able to delete the ${c}. Try after sometime!`,"error")}},n=d=>{const c=new Date(d);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(c)};let a=null;if(t.channelName==="Webchat")a=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-lg mb-3",children:"Chat window Script Tag"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsx("span",{className:"font-mono text-xs sm:text-sm break-all flex-1",children:t.scriptTag}),e.jsx(B.CopyToClipboard,{text:t.scriptTag,onCopy:()=>v(!0,"chat script copied to clipboard","success"),children:e.jsx(C,{label:"Copy",type:"primary",style:{width:"100%",maxWidth:"120px"}})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-semibold",children:"Integrated At: "}),e.jsx("span",{className:"text-sm",children:n(t.integratedAt)})]})]});else if(t.channelName==="whatsapp"){const d=`${Y}/whatsapp/${t.organizationId}/${t.botId}/${t._id}/entrypoint`,c=ve(t.organizationId,t.botId);a=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx("div",{className:"font-bold text-lg",children:"WhatsApp Integration"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(C,{label:"Edit",type:"plain",onClick:()=>{R(e.jsx(ce,{botId:t.botId,organizationId:t.organizationId,setPopUpDialog:()=>{},whatsappIntegrationObj:t,edit:!0}),{showCloseButton:!0,width:"700px"})}}),e.jsx(C,{label:"Delete",type:"plain",onClick:()=>i(!0)}),e.jsx(H,{title:"Delete Whatsapp integration?",open:m,setOpen:i,onConfirm:()=>u(t,"Whatsapp integration"),children:"Confirm the deletion of Whatsapp integration."})]})]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"App Name:"})," ",t.appName]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base break-all",children:[e.jsx("b",{children:"App Id:"})," ",t.appId]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base break-all",children:[e.jsx("b",{children:"Phone Number ID:"})," ",t.phoneNumberId]}),e.jsx($,{label:"Webhook Callback Url:",value:d,onCopy:()=>v(!0,"Web hook callback url copied to clipboard","success")}),e.jsx($,{label:"Webhook Verification Token:",value:c,onCopy:()=>v(!0,"Webhook Verification Token copied to clipboard","success")}),e.jsx($,{label:"Access Token:",value:t.verificationToken,onCopy:()=>v(!0,"Access Token copied to clipboard","success")}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"Initial Lead Category:"})," ",t.leadCategory||"preSales"]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"Categorize to Presale after no of conversations:"})," ",t.leadUpgradeToPreSaleCount||""]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-semibold",children:"Integrated At: "}),e.jsx("span",{className:"text-sm",children:n(t.integratedAt)})]})]})}else if(t.channelName==="gupshup"){const d=`${Y}/gupshup/${t.organizationId}/${t.botId}/${t._id}/entrypoint`;a=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsx("div",{className:"font-bold text-lg",children:"Gupshup Integration"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(C,{label:"Edit",type:"plain",onClick:()=>{R(e.jsx(de,{botId:t.botId,organizationId:t.organizationId,setPopUpDialog:()=>{},gupshupIntegrationObj:t,edit:!0}),{showCloseButton:!0,width:"700px"})}}),e.jsx(C,{label:"Delete",type:"plain",onClick:()=>i(!0)}),e.jsx(H,{title:"Delete Gupshup integration?",open:m,setOpen:i,onConfirm:()=>u(t,"Gupshup integration"),children:"Confirm the deletion of Gupshup integration."})]})]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"App Name:"})," ",t.appName]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base break-all",children:[e.jsx("b",{children:"App Id:"})," ",t.appId]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base break-all",children:[e.jsx("b",{children:"Phone Number:"})," ",t.phoneNumberId]}),e.jsx($,{label:"Webhook Callback Url:",value:d,onCopy:()=>v(!0,"Web hook callback url copied to clipboard","success")}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"Initial Lead Category:"})," ",t.leadCategory||"preSales"]}),e.jsxs("div",{className:"mb-2 text-sm sm:text-base",children:[e.jsx("b",{children:"Categorize to Presale after no of conversations:"})," ",t.leadUpgradeToPreSaleCount||""]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-semibold",children:"Integrated At: "}),e.jsx("span",{className:"text-sm",children:n(t.integratedAt)})]})]})}else t.channelName==="CRM_Callback"&&(a=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-bold text-lg mb-3",children:"CRM Callback URL"}),s?e.jsx(C,{label:"Edit",type:"plain",onClick:()=>{R(e.jsx(ie,{botId:t.botId,organizationId:t.organizationId,setPopUpDialog:()=>{},crmIntegrationObj:t,edit:!0}),{showCloseButton:!0,width:"700px"})}}):e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[e.jsx("span",{className:"font-mono text-xs sm:text-sm break-all flex-1",children:t.callbackURL}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(C,{label:"Edit",type:"plain",onClick:()=>b(!0)}),e.jsx(C,{label:"Delete",type:"plain",onClick:()=>i(!0)}),e.jsx(B.CopyToClipboard,{text:t.callbackURL,onCopy:()=>v(!0,"CRM callback URL copied to clipboard","success"),children:e.jsx(C,{label:"Copy",type:"primary"})})]}),e.jsx(H,{title:"Delete CRM callback URL?",open:m,setOpen:i,onConfirm:()=>u(t,"crm callback url"),children:"Confirm the deletion of CRM callback URL."})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-semibold",children:"Integrated At: "}),e.jsx("span",{className:"text-sm",children:n(t.integratedAt)})]})]}));return e.jsx("div",{className:"bg-white rounded shadow p-4 mb-4",children:a})}function Be({admins:t,index:s,handleBlur:b,handleChange:m,errors:i,touched:u,remove:n}){return e.jsx("div",{className:"mb-4 border-b pb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(w,{label:"Admin Name",id:`admins.${s}.adminName`,name:`admins.${s}.adminName`,type:"text",value:t.adminName,onBlur:b,onChange:m,autoComplete:"off",disabled:s===0,className:s!==0&&u.admins?.[s]?.adminName&&i.admins?.[s]?.adminName?"border-red-500":""}),s!==0&&u.admins?.[s]?.adminName&&i.admins?.[s]?.adminName&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:i.admins[s].adminName})]}),e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx(w,{label:"Role",id:`admins.${s}.role`,name:`admins.${s}.role`,type:"text",value:t.role,onBlur:b,onChange:m,autoComplete:"off",disabled:s===0,className:s!==0&&u.admins?.[s]?.role&&i.admins?.[s]?.role?"border-red-500":""}),s!==0&&u.admins?.[s]?.role&&i.admins?.[s]?.role&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:i.admins[s].role})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(w,{label:"Email",id:`admins.${s}.email`,name:`admins.${s}.email`,type:"text",value:t.email,onBlur:b,onChange:m,autoComplete:"off",disabled:s===0,className:s!==0&&u.admins?.[s]?.email&&i.admins?.[s]?.email?"border-red-500":""}),s!==0&&u.admins?.[s]?.email&&i.admins?.[s]?.email&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:i.admins[s].email})]}),s!==0&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Delete"}),e.jsx(C,{type:"plain",label:"ðŸ—‘ï¸",className:"text-2xl text-red-600",onClick:()=>n(s)})]})]})})}function qe({organizationId:t}){const b={admins:V(a=>a.organization?.admins)||[],submit:""},m=new RegExp(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),i=D().shape({admins:ge().of(Ne(a=>a.index===0?D().shape({}):D().shape({adminName:T().required("Admin Name is required"),role:T().required("Role is required"),email:T().trim().required("Email is required").email("Invalid email id").matches(m,"Invalid email id")})))}),u=a=>a.map((d,c)=>({...d,itemNo:c+1})),n=async(a,{setErrors:d,setStatus:c,setSubmitting:g})=>{try{const{submit:h,...r}=a;g(!0),await Te(r,t),v(!0,"Lead email ids updated successfully","success"),c({success:!0})}catch(h){c({success:!1}),d({submit:h.message}),g(!1),v(!0,h.message,"error")}};return e.jsxs("div",{className:"bg-white rounded shadow p-4 mb-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("strong",{children:"Lead emails are sending to below given email ids"}),e.jsx("br",{}),e.jsx("br",{})]}),e.jsx(q,{initialValues:b,onSubmit:n,validationSchema:i,children:({errors:a,handleBlur:d,handleChange:c,handleSubmit:g,touched:h,values:r,setFieldValue:y,isSubmitting:I})=>e.jsx("form",{onSubmit:g,children:e.jsx(ye,{name:"admins",children:({push:f,remove:k})=>e.jsxs(e.Fragment,{children:[r.admins.map((W,U)=>e.jsx(Be,{admins:W,index:U,handleBlur:d,handleChange:c,errors:a,touched:h,remove:S=>{k(S);const _=u(r.admins.filter((l,o)=>o!==S));y("admins",_)}},U)),e.jsxs("div",{className:"flex flex-wrap justify-end gap-4 mt-4",children:[e.jsx(C,{type:"secondary",className:"ml-2",onClick:()=>{f({adminName:"",role:"",email:""})},label:"Add Email"}),e.jsx(C,{type:"primary",className:"ml-2",disabled:I,isLoading:I,htmlType:"submit",label:"Save Changes"})]}),typeof a.submit=="string"&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:a.submit})]})})})})]})}const We=({actions:t,isOpen:s,onClose:b,className:m})=>s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:b}),e.jsx("div",{className:Q("absolute right-0 top-[60px] z-50 animate-in fade-in slide-in-from-top-2 duration-200",m),children:e.jsx("div",{className:"flex flex-col items-end space-y-3",children:t.map((i,u)=>e.jsxs("div",{className:"flex items-center group",style:{animationDelay:`${u*50}ms`,animation:"slideInRight 0.3s ease-out forwards"},children:[e.jsxs("div",{className:"mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx("span",{className:"bg-gray-800 text-white text-sm px-3 py-2 rounded-lg shadow-lg whitespace-nowrap",children:i.name}),e.jsx("div",{className:"absolute right-[-6px] top-1/2 transform -translate-y-1/2 w-0 h-0 border-l-[6px] border-l-gray-800 border-t-[6px] border-t-transparent border-b-[6px] border-b-transparent"})]}),e.jsxs("button",{className:Q("relative w-12 h-12 rounded-full shadow-lg flex items-center justify-center transition-all duration-200 transform","hover:scale-110 hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300",{"bg-white from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700":!i.disabled,"bg-gray-300 text-gray-500 cursor-not-allowed":i.disabled}),onClick:()=>{i.disabled||(b(),i.method())},disabled:i.disabled,title:i.name,children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:i.icon}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 opacity-0 scale-0 transition-all duration-300 pointer-events-none hover:opacity-30 hover:scale-100"})]})]},i.name))})}),e.jsx("style",{children:`
        @keyframes slideInRight {
          from {
            opacity: 0;
            transform: translateX(20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }
      `})]}):null;function ia(){const[t]=Pe(),s=be(f=>f.botsList),b=V(f=>f.organizationId),m=V(f=>f.isSuperUser),[i,u]=K.useState(!1);he.useEffect(()=>{(async()=>{const k={organizationId:b,botId:t};try{await we(k)}catch{v(!0,"Not able to fetch integrations details. Try after sometime!","error")}})()},[t,b]);const n=s.find(f=>f._id===t)?.integrations;let a=null,d=null,c=null;n!==void 0&&(a=n.find(f=>f.channelName==="CRM_Callback"),d=n.find(f=>f.channelName==="whatsapp"),c=n.find(f=>f.channelName==="gupshup"));const g=()=>{R(d?e.jsx("div",{children:"The Whatsapp integration already configured."}):e.jsx(ce,{botId:t,organizationId:b,setPopUpDialog:()=>{}}),{showCloseButton:!0,width:"500px"})},h=()=>{R(a?e.jsx("div",{children:"The CRM Callback URL has been successfully configured."}):e.jsx(ie,{botId:t,organizationId:b,setPopUpDialog:()=>{}}),{showCloseButton:!0,width:"500px"})},r=()=>{R(c?e.jsx("div",{children:"The Gupshup integration already configured."}):e.jsx(de,{botId:t,organizationId:b,setPopUpDialog:()=>{}}),{showCloseButton:!0,width:"500px"})},y=[{name:"WhatsApp Integration",icon:e.jsx(ee,{}),method:g},{name:"CRM Callback",icon:e.jsx(Ie,{}),method:h},{name:"Gupshup Integration",icon:e.jsx(ee,{}),method:r}],I=m?y:y.filter(f=>f.name!=="Gupshup Integration");return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-4 relative",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(De,{title:"Integrations",icon:i?Ue:Se,onClick:()=>u(f=>!f)}),e.jsx(We,{actions:I,isOpen:i,onClose:()=>u(!1)})]})}),e.jsxs("div",{className:"space-y-4",children:[n&&n.map((f,k)=>f.channelId!=="callConnect_123"&&e.jsx($e,{integrationObj:f},k)),m&&e.jsx(qe,{organizationId:b})]})]})}export{ia as default};
