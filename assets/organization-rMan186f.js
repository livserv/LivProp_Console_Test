import{g,p as r,t as S}from"./ajax-Eg2F-GfI.js";import{c as o,d as f}from"./index-DtJcC2z6.js";async function z(e,t){const a=await l(),{organizationId:n}=o.getState();return e?e!==n&&o.setState({organizationId:e}):e=n,e&&(a||await y(e),await p(e,t)),!0}async function l(){const e=o.getState();let{organizationList:t,organizationId:a,organization:n}=e;if(!(!e.isSuperUser||Array.isArray(t))){if(t=await r("/organization/list",null),t!=null&&t.length)if(a=a||sessionStorage.getItem("orgId"),a)n||(n=t==null?void 0:t.filter(i=>i._id===a)[0]);else{const i=t[0];a=i._id,n=i}return o.setState({organizationList:t,organizationId:a,organization:n}),!0}}async function w(e,t){t||(t=o.getState().organizationId);const a=await S(`/organization/${t}`,e);o.setState(n=>{const{organizationList:i,organizationId:u,organization:c}=n,s={};return u===t&&(s.organization={...c,...a}),i&&(s.organizationList=i.map(d=>d._id===t?{...d,...a}:d)),s})}function O(e){if(!e||typeof e!="object")return;let{organization:t}=o.getState();t&&(t={...t,...e},o.setState({organization:t}))}async function p(e,t){var u;const a=await g(`/bot/${e}/list`),n=t||((u=a[0])==null?void 0:u._id),i=a.reduce((c,s)=>(c[s._id]=s,c),{});return o.setState({organizationId:e}),f.setState({botsList:a,botsMap:i,selectedBotId:n}),n}async function y(e){const t=await r("/organization/get-organization-by-id",{organizationId:e});o.setState({organization:t})}function h(e){f.setState({selectedBotId:e})}async function B(e,t){const{organizationId:a}=o.getState(),n={countryCode:e,phoneNumber:t};return await r(`/organization/${a}/add-phone-number`,n)}async function _(e,t,a){const{organizationId:n}=o.getState(),i={countryCode:e,phoneNumber:t,otp:a};return await r(`/organization/${n}/validate-phone-number`,i)}async function $(e,t){const{organizationId:a}=o.getState(),n={countryCode:e,phoneNumber:t};return await r(`/organization/${a}/resend-phone-number-otp`,n)}export{B as a,w as b,p as c,z as l,$ as r,h as s,O as u,_ as v};
