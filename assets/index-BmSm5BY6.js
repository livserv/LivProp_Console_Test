import{a as $,b as j,R as i,j as o}from"./index-C7fnFzPB.js";import{g as v,f as w}from"./ajax-B2Rl2-q_.js";import{a as y,C as D}from"./index-C8aRLfqW.js";import"./env-CmL5wTXD.js";import"./svg-icons-DjWu_wq0.js";import"./env-CBDBHzQq.js";import"./index-CBDzWhz_.js";function E(){const{organizationId:t,botId:s,recipientId:m,chatId:p}=$(),{isAuthenticated:h}=j(),[r,l]=i.useState(),[a,u]=i.useState(),[,f]=i.useState(),g=`/bot/${t}/${s}/chat/history/${m}/${p}?includeBot=1${h?"&includeKB=1":""}${a!=null&&a.code?`&language=${encodeURIComponent(a.code)}`:""}`;if(i.useEffect(()=>{v(g).then(e=>{var n;const c=w((n=e.messages[0])==null?void 0:n.createdAt);e.botDesign=y(e.botDesign,{window:{width:"600px",height:"calc(100vh - 120px)"},header:{titleText:c+` (${e.titleText})`}}),l(R(e))},e=>{console.error("Unable to load chat conversations:",e)})},[g]),!r)return o.jsx("div",{children:"Loading... Please wait..."});const x=e=>{const{role:c,type:n,passedDocIds:d,searchQuery:b}=e||{};if(!(c!=="assistant"||n!=="text"||!(d!=null&&d.length)&&!b))return o.jsx("span",{className:"show-icon",onClick:()=>f(e),children:"="})};return o.jsx("div",{className:"conversation-history"+(h?" authenticated":""),children:o.jsx("div",{children:o.jsx(D,{botDesign:r.botDesign,messages:r.messages,showTime:!0,disabledMessage:!0,optionsRenderer:x,language:a,setLanguage:u,activateVoiceBot:!1})})})}function R(t){const s=t.messages.length&&t.messages[t.messages.length-1];return(s==null?void 0:s.type)==="options"&&(s.content=""),t}export{E as default};
