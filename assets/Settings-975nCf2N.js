import{j as e,d as L,c as M,R as v}from"./index-DRJqiOpO.js";import{a as S,F as B}from"./formik.esm-BEzsm-Qr.js";import{a as K}from"./index-C5RmPiBV.js";import{c as I,f as T,a as N}from"./index.esm-CvA83Myd.js";import{S as E}from"./delete-CZ8PMLkd.js";import{B as C}from"./Button-Ccb5u35P.js";import"./ajax-DXwcB5wn.js";import"./Button-BYKtkuYt.js";import{T as f}from"./TextBox-CyjiDmoK.js";import{A as R}from"./AnimateButton-CKCdYP38.js";import{P as D}from"./ProgressButton-fHN2RQcm.js";import{Y as w}from"./YesNoDropdown-CLbABa7F.js";import{s as F}from"./bots-pK3tPUKV.js";import{u as A}from"./useSelectedBot-DsH6bLZh.js";import{P as G}from"./PageHeader-hk1ToCf0.js";import"./env-CmL5wTXD.js";import"./SelectBox-BfGkOX4w.js";import"./organization-CK2xg6eg.js";function $({values:s,errors:a,touched:n,handleBlur:d,handleChange:t,setFieldValue:l,isSubmitting:u}){const i=s.chatReportPropList||[],x=c=>c.map((g,m)=>({...g,itemNo:m+1}));return e.jsxs("div",{className:"w-full col-span-12",children:[e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("div",{className:"px-4 text-gray-600 font-medium text-base",children:"Add columns to Excel sheet"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),e.jsx("div",{className:"col-span-6 border-b",children:e.jsx(S,{name:"chatReportPropList",children:({push:c})=>e.jsxs(e.Fragment,{children:[i.length===0&&e.jsx("div",{className:"flex justify-center items-center py-4 text-gray-500 text-sm",children:"No chat property columns have been added to the Excel sheet yet."}),i.map((g,m)=>e.jsx(W,{leadProps:g,index:m,handleBlur:d,handleChange:t,errors:a,touched:n,remove:j=>{const r=i.filter((o,p)=>p!==j);l("chatReportPropList",x(r))}},m)),e.jsx("div",{className:"flex flex-wrap justify-end mb-2",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"ml-2",type:"primary",size:"sm",label:"+",onClick:()=>c({label:"",prop:""}),disabled:u,title:"Add Excel sheet columns"})})})]})})})]})}function W({leadProps:s,index:a,handleBlur:n,handleChange:d,errors:t,touched:l,remove:u}){var c,g,m,j,r,o,p,h;const i=((g=(c=l==null?void 0:l.chatReportPropList)==null?void 0:c[a])==null?void 0:g.label)&&((j=(m=t==null?void 0:t.chatReportPropList)==null?void 0:m[a])==null?void 0:j.label),x=((o=(r=l==null?void 0:l.chatReportPropList)==null?void 0:r[a])==null?void 0:o.prop)&&((h=(p=t==null?void 0:t.chatReportPropList)==null?void 0:p[a])==null?void 0:h.prop);return e.jsx("div",{className:"w-full lg:w-9/12",children:e.jsx("div",{className:"mb-4 pb-4 col-span-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(f,{id:`chatReportPropList.${a}.label`,name:`chatReportPropList.${a}.label`,label:"Label",type:"text",value:s.label,onBlur:n,onChange:d,autoComplete:"off",placeholder:"Project",className:i?"border-red-500":""}),i&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:t.chatReportPropList[a].label})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(f,{id:`chatReportPropList.${a}.prop`,name:`chatReportPropList.${a}.prop`,label:"Prop Name",type:"text",value:s.prop,onBlur:n,onChange:d,autoComplete:"off",placeholder:"fld1",className:x?"border-red-500":""}),x&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:t.chatReportPropList[a].prop})]}),e.jsx("div",{className:"flex flex-col items-center ",children:e.jsx(C,{type:"plain",icon:e.jsx(E,{}),size:"lg",className:"text-2xl text-red-600",onClick:()=>u(a)})})]})})})}function X({tagManagerIds:s,index:a,handleBlur:n,handleChange:d,errors:t,touched:l,remove:u}){var c,g,m,j,r,o,p,h;const i=((g=(c=l==null?void 0:l.urlBasedGoogleTagManagerIds)==null?void 0:c[a])==null?void 0:g.url)&&((j=(m=t==null?void 0:t.urlBasedGoogleTagManagerIds)==null?void 0:m[a])==null?void 0:j.url),x=((o=(r=l==null?void 0:l.urlBasedGoogleTagManagerIds)==null?void 0:r[a])==null?void 0:o.tagManagerId)&&((h=(p=t==null?void 0:t.urlBasedGoogleTagManagerIds)==null?void 0:p[a])==null?void 0:h.tagManagerId);return e.jsx("div",{className:"w-full lg:w-9/12",children:e.jsx("div",{className:"mb-4 pb-4 col-span-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(f,{id:`urlBasedGoogleTagManagerIds.${a}.url`,name:`urlBasedGoogleTagManagerIds.${a}.url`,label:"Page Url",type:"text",value:s.url,onBlur:n,onChange:d,autoComplete:"off",placeholder:"www.url.com",className:i?"border-red-500":""}),i&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:t.urlBasedGoogleTagManagerIds[a].url})]}),e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx(f,{id:`urlBasedGoogleTagManagerIds.${a}.tagManagerId`,name:`urlBasedGoogleTagManagerIds.${a}.tagManagerId`,label:"Tag Manager Id",type:"text",value:s.tagManagerId,onBlur:n,onChange:d,autoComplete:"off",placeholder:"GTM-XXXXXX",className:x?"border-red-500":""}),x&&e.jsx("div",{className:"text-red-600 text-xs mt-1",children:t.urlBasedGoogleTagManagerIds[a].tagManagerId})]}),e.jsx("div",{className:"flex flex-col items-center ",children:e.jsx(C,{type:"plain",icon:e.jsx(E,{}),size:"lg",className:"text-2xl text-red-600",onClick:()=>u(a)})})]})})})}function z({values:s,errors:a,touched:n,handleBlur:d,handleChange:t,setFieldValue:l,isSubmitting:u}){const i=s.urlBasedGoogleTagManagerIds||[],x=c=>c.map((g,m)=>({...g,itemNo:m+1}));return e.jsxs("div",{className:"w-full col-span-12",children:[e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300"}),e.jsx("div",{className:"px-4 text-gray-600 font-medium text-base",children:"Url based Tag Manager Id"}),e.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),e.jsx("div",{className:"col-span-6 border-b",children:e.jsx(S,{name:"urlBasedGoogleTagManagerIds",children:({push:c})=>e.jsxs(e.Fragment,{children:[i.length===0&&e.jsx("div",{className:"flex justify-center items-center py-4 text-gray-500 text-sm",children:"No Google TagManager Id added yet"}),i.map((g,m)=>e.jsx(X,{tagManagerIds:g,index:m,handleBlur:d,handleChange:t,errors:a,touched:n,remove:j=>{const r=i.filter((o,p)=>p!==j);l("urlBasedGoogleTagManagerIds",x(r))}},m)),e.jsx("div",{className:"flex flex-wrap justify-end mb-2",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"ml-2",type:"primary",size:"sm",label:"+",onClick:()=>c({url:"",tagManagerId:""}),disabled:u,title:"Add Tag Manager Id"})})})]})})})]})}const q={leadCaptureType:"flow",leadCaptureFormMode:"count",showFormAfterChats:3,defaultCountryCode:{countryId:"in",dialCode:"+91"},isWhatsAppEnabled:!1},U=I().shape({urlBasedGoogleTagManagerIds:T().of(I().shape({url:N().trim().required("URL is required"),tagManagerId:N().trim().required("Tag Manager ID is required").matches(/^GTM-[A-Z0-9]+$/,"Format must be GTM-XXXXXX")})),chatReportPropList:T().of(I().shape({label:N().trim().required("Label is required"),prop:N().trim().required("Prop Name is required")}))});function ge(){const s=L(l=>l.isSuperUser),[a,n]=A();if(!n)return null;const{botSettings:d=q}=n||{},t=async(l,{setErrors:u,setStatus:i,setSubmitting:x})=>{try{await F(a,l),i({success:!1}),x(!1),M(!0,"Settings saved successfully!","success")}catch(c){console.error(c),M(!0,"Unable to save settings. Please try again later.","error"),i({success:!1}),u({submit:c.message}),x(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Bot Settings"}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 border rounded-lg shadow bg-white mt-6",children:e.jsx(B,{initialValues:d,onSubmit:t,validationSchema:U,enableReinitialize:!0,children:l=>e.jsx("form",{noValidate:!0,onSubmit:l.handleSubmit,children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(O,{...l}),e.jsx(_,{...l}),e.jsx(Y,{...l}),e.jsx(H,{...l}),s&&e.jsx($,{...l}),s&&e.jsx(z,{...l}),e.jsx(V,{...l})]})})},a)})]})}function b(s){s.key==="Enter"&&s.preventDefault()}function O({values:s,touched:a,errors:n,handleBlur:d,handleChange:t,setFieldValue:l}){var j,r,o,p;const u=s.leadCaptureType==="form",i=s.leadCaptureType!=="form"||s.leadCaptureFormMode==="keyword",[x,c]=v.useState(((j=s.defaultCountryCode)==null?void 0:j.countryId)||"in"),[g,m]=v.useState(((r=s.defaultCountryCode)==null?void 0:r.dialCode)||"+91");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Lead Capture Settings"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Input Type"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureType",value:"flow",checked:s.leadCaptureType==="flow",onChange:t,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Flow"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureType",value:"form",checked:s.leadCaptureType==="form",onChange:t,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Form"})]})]})]})}),u&&e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"When you want the form to be displayed?"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureFormMode",value:"keyword",checked:s.leadCaptureFormMode==="keyword",onChange:t,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Show form when the keyword matches"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"leadCaptureFormMode",value:"count",checked:s.leadCaptureFormMode==="count",onChange:t,className:"text-blue-600"}),e.jsxs("span",{className:"text-sm flex items-center",children:["Show form after conversations:",e.jsx("input",{type:"text",value:(o=s.showFormAfterChats)==null?void 0:o.toString(),maxLength:2,className:"w-12 ml-2 px-1 border border-gray-300 rounded text-center",disabled:s.leadCaptureType!=="form"||s.leadCaptureFormMode&&s.leadCaptureFormMode!=="count",onChange:h=>l("showFormAfterChats",P(h.target.value,s.showFormAfterChats)),onKeyDown:b})]})]})]})]})}),!u&&e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Can user proceed without providing contact details?"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:s.leadCaptureFlowMandatory||!1,name:"leadCaptureFlowMandatory",onChange:t,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Make the input mandatory"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:s.isWhatsAppEnabled,name:"isWhatsAppEnabled",onChange:t,className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Is WhatsApp Enabled"})]})]})]})}),e.jsx("div",{className:"col-span-12",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Default Phone number country code in contact form"})}),e.jsxs("div",{className:"col-span-12 md:col-span-3 flex items-center",children:[e.jsx(K,{selectedCountry:x,onSelect:({iso2:h,dialCode:y})=>{c(h),l("defaultCountryCode",{countryId:h,dialCode:"+"+y}),m("+"+y)}}),e.jsx("span",{className:"ml-2",children:g})]}),e.jsx("div",{className:"col-span-12",children:e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:["Number of visitor messages send to GPT for answer",e.jsx("input",{type:"text",value:((p=s.maxChatMessagesToSentToGPT)==null?void 0:p.toString())||"17",maxLength:2,className:"w-12 ml-2 px-1 border border-gray-300 rounded text-center",onChange:h=>l("maxChatMessagesToSentToGPT",P(h.target.value,s.maxChatMessagesToSentToGPT)),onKeyDown:b})]})}),i&&e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Keywords for Phone Number Collection *"}),e.jsx(k,{name:"phoneNumberKeywords",value:s.phoneNumberKeywords||[],error:!!(a.phoneNumberKeywords&&n.phoneNumberKeywords),onBlur:d,onChange:l,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),a.phoneNumberKeywords&&n.phoneNumberKeywords&&e.jsx("div",{className:"text-red-500 text-sm",children:n.phoneNumberKeywords})]})}),i&&e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Keywords for Email Address Collection *"}),e.jsx(k,{name:"emailKeywords",value:s.emailKeywords||[],error:!!(a.emailKeywords&&n.emailKeywords),onBlur:d,onChange:l,placeholder:"Type keyword and press enter to add more...",inputProps:{maxLength:25}}),a.emailKeywords&&n.emailKeywords&&e.jsx("div",{className:"text-red-500 text-sm",children:n.emailKeywords})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-12 mb-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Validate Contact For Each Chat"}),e.jsx(w,{name:"validateContactForEachChat",value:s.validateContactForEachChat,onChange:(h,y)=>l(h,y),className:"border h-12 rounded-md w-full"})]})})]})}function _({values:s,handleChange:a}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Bot Industry and Role settings"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(f,{label:"Industry",name:"industry",value:s.industry||"",onChange:a,onKeyDown:b})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(f,{label:"Bot Role",name:"botRole",value:s.botRole||"",onChange:a,onKeyDown:b})}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsx(f,{label:"Organization Name",name:"organizationName",value:s.organizationName||"",onChange:a,onKeyDown:b})})]})}function Y({values:s,handleChange:a}){const n=L(d=>d.isSuperUser);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Allow / Block chat window"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Allowed IP",name:"allowedIP",value:s.allowedIP||"",onChange:a,placeholder:"Ex: 192.167.22.340, 192.167.22.341",onKeyDown:b})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Denied IP",name:"deniedIP",value:s.deniedIP||"",onChange:a,placeholder:"Ex: 192.167.22.340, 192.167.22.341",onKeyDown:b})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Allowed Pages",name:"allowedPages",value:s.allowedPages||"",onChange:a,placeholder:"Ex: https://xyz.com, https://abc.com",onKeyDown:b})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Denied Pages",name:"deniedPages",value:s.deniedPages||"",onChange:a,placeholder:"Ex: https://xyz.com, https://abc.com",onKeyDown:b})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Allowed Countries",name:"allowedCountries",value:s.allowedCountries||"",onChange:a,placeholder:"Ex: India, Oman, Australia",onKeyDown:b})}),e.jsx("div",{className:"col-span-12 md:col-span-6",children:e.jsx(f,{label:"Denied Countries",name:"deniedCountries",value:s.deniedCountries||"",onChange:a,placeholder:"Ex: Sri Lanka, Bhutan",onKeyDown:b})})]})]})}function H({values:s,setFieldValue:a}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-span-12",children:[e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"px-4 text-lg font-medium text-gray-600",children:"Activate Consolidated Leads Reports"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-12 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Daily Consolidated Lead Email"}),e.jsx(w,{name:"sendDailyConsolidatedLeadEmail",value:s.sendDailyConsolidatedLeadEmail,onChange:(n,d)=>a(n,d),className:"border h-12 rounded-md w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Weekly Consolidated Lead Email"}),e.jsx(w,{name:"sendWeeklyConsolidatedLeadEmail",value:s.sendWeeklyConsolidatedLeadEmail,onChange:(n,d)=>a(n,d),className:"border h-12 rounded-md w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Monthly Consolidated Lead Email"}),e.jsx(w,{name:"sendMonthlyConsolidatedLeadEmail",value:s.sendMonthlyConsolidatedLeadEmail,onChange:(n,d)=>a(n,d),className:"border h-12 rounded-md w-full"})]})]})]})})}function V({errors:s,isSubmitting:a}){return e.jsxs(e.Fragment,{children:[s.submit&&e.jsx("div",{className:"col-span-12",children:e.jsx("div",{className:"text-red-500 text-sm",children:s.submit})}),e.jsx("div",{className:"col-span-12 mt-4",children:e.jsx(R,{children:e.jsx(D,{disableElevation:!0,isLoading:a,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",className:"w-full",children:"Save Settings"})})})]})}function P(s,a){if(s)return isNaN(Number(s))?a:Number(s)}function k({name:s,value:a,onChange:n,placeholder:d,inputProps:t,...l}){const u=v.useRef(null),[i,x]=v.useState(""),c=r=>n(s,r),g=r=>{const o=r.target.value;if(x(o),o.endsWith(",")||o.endsWith(" ")){const p=o.replace(/[, ]+$/,"").trim();if(p){const h=[...a,p];c(h),x("")}}},m=r=>{if(r.key==="Enter"||r.key===","){r.preventDefault();const o=i.trim();if(o){const p=[...a,o];c(p),x("")}}else if(r.key==="Backspace"&&!i&&a.length>0){const o=a.slice(0,-1);c(o)}},j=r=>{const o=a.filter((p,h)=>h!==r);c(o)};return e.jsxs("div",{className:"border border-gray-300 rounded-md p-2 flex flex-wrap gap-1 min-h-[40px]",children:[a.map((r,o)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[r,e.jsx("button",{type:"button",onClick:()=>j(o),className:"ml-1 text-blue-600 hover:text-blue-800",children:"Ã—"})]},o)),e.jsx("input",{ref:u,type:"text",value:i,onChange:g,onKeyDown:m,placeholder:a.length===0?d:"",className:"flex-1 min-w-[120px] border-none outline-none bg-transparent",maxLength:t==null?void 0:t.maxLength,...l})]})}export{ge as default};
