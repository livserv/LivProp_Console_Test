import{p as f,g as S,l as d}from"./ajax-CVEl0eD2.js";import{b as r,e as l}from"./index-DNgbtrVq.js";async function m(e,t){const s=await g(),{organizationId:a}=r.getState();return e?e!==a&&r.setState({organizationId:e}):e=a,e&&(s||await w(e),await p(e,t)),!0}async function g(){const e=r.getState();let{organizationList:t,organizationId:s,organization:a}=e;if(!(!e.isSuperUser||Array.isArray(t))){if(t=await f("/organization/list",null),t!=null&&t.length)if(s=s||sessionStorage.getItem("orgId"),s)a||(a=t==null?void 0:t.filter(i=>i._id===s)[0]);else{const i=t[0];s=i._id,a=i}return r.setState({organizationList:t,organizationId:s,organization:a}),!0}}async function B(e,t){t||(t=r.getState().organizationId);const s=await d(`/organization/${t}`,e);r.setState(a=>{const{organizationList:i,organizationId:o,organization:u}=a,n={};return o===t&&(n.organization={...u,...s}),i&&(n.organizationList=i.map(c=>c._id===t?{...c,...s}:c)),n})}async function p(e,t){var o;const s=await S(`/bot/${e}/list`),a=t||((o=s[0])==null?void 0:o._id),i=s.reduce((u,n)=>(u[n._id]=n,u),{});return r.setState({organizationId:e}),l.setState({botsList:s,botsMap:i,selectedBotId:a}),a}async function w(e){const t=await f("/organization/get-organization-by-id",{organizationId:e});r.setState({organization:t})}function _(e){l.setState({selectedBotId:e})}export{p as a,m as l,_ as s,B as u};
